forbidden = "<>[]{}%$#@^*~"
forbidden_array = [ ord( c ) for c in forbidden ]

def fill_bits( sequence ):
	while len( sequence ) < 8:
		sequence = "0" + sequence
	return sequence

def sequence_to_dec( sequence ):
	result = []
	array = sequence.split()
	for element in array:
		result.append( int( element, 2 ) )
	return result

def xor( sequence1, sequence2 ):
	counter = 0
	result = []
	for number in sequence1:
		result.append( sequence1[ counter ] ^ sequence2[ counter ] )
		counter = counter + 1
	return result

def crib_to_dec( sequence ):
	result = []
	for char in sequence:
		result.append( ord( char ) )
	return result

def xor_crib_at( sequence, crib, at ):
	length = len( crib )
	result = []
	counter = 0
	for i in range( at, at + length ):
		xor_value = sequence[ i ] ^ crib[ counter ]
		if xor_value not in forbidden_array:
			result.append( xor_value )
		counter = counter + 1
	return result

def result_to_string( sequence ):
	result = ""
	for number in sequence:
		result = result + chr( number )
	return result

def result_to_bin( sequence ):
	result = ""
	for number in sequence:
		result = result + fill_bits( bin( number )[ 2: ] ) + " "
	return result

def generate_keys( message, cipher ):
	keys = []
	for i in range( 0, 256 ):
		if message ^ i == cipher:
			keys.append( i )
	return keys

# def generate_multiple_keys( stream, cipher_stream ):

'''
c4 = sequence_to_dec("00111111 11100111 01111100 00111010 01111001 00111000 00111011 10100110 01011001 01001001 10000000 11101110 10010110 10100110 00100101 11100110 01001001 10001000 11101000 00011001 11010101 00010111 10110010 01010010 10110011 11100011 00110101 01011111 10110010 01100100 10001000 11100011 00011001 11101001 10101010 01010010 01101000 00110001 11011000 10010001 01100110 10110001 00111011 00001000 01110001 10110111 11001101 00101011 11001001 10000111 01110000 11100001 10101111 00011101 01111100 10010010 10001001 01001010 10110111 11100100 10010111 01101011 10100111 10101011 10000010 10000111 10011100 11010000 00111110 01010101 00101011 10001110 01011100 10001110 11011111 00101111 10010110 01001001 00000111 00100001 01000011 11010001 00011000 11000010 10101001 10000101 11100110 01111110 11100011 10001100 10000110 10111011 00001110 10100110 01110011 10111010 00000100 10101111 10100011 00110100 00110010 01001110 00011000 10110100 10100000 11101011 10110110 01100010 01110010 01110011 01110111 11110100 00010010 11000111 11011010 11001011 00010101 11010010 10110011 11111000 11110011 10100101 11000000 01110110 00110101 10110101 00000010 11001101 11110111 11101011 11011010 01100010 01001000 00011111 00111100 01100101 00000011 00110110 10100111 00110010 00111100 11110000 01011110 10011010 10000001 01101000 00100100 11110011 10101100 01111010 00101111 01010101 01100001 11110111 10011010 00101101 10001010 10011001 11001011 11111000 10001000 00110111 10111001 01100000 11011001 01000110 10110111")

c14 = sequence_to_dec("00100101 11101110 01110011 00110111 01111110 00101010 00111011 10100010 01011000 00011011 10001111 10100111 10010110 10100000 01101000 11101011 00010111 11011100 11110100 01010001 11011100 00000110 10110010 01010001 10110011 11101111 00100100 01010010 10110010 01110001 10001000 10100110 00010100 10101000 10110101 01011011 00101101 00111110 11010100 11000011 01011110 10101011 00101010 01000000 00010011 10111010 10001000 00101011 11010101 10001101 01110000 11101111 10101110 00010010 01110100 10000101 11000111 01010000 10111111 11100111 10010101 01101011 10100100 10101100 10010010 11001011 10011110 10000010 00101000 01001011 00100110 11000010 01011101 11000001 11001100 00110010 11011111 01010100 00010111 01100100 01000010 11000000 01010100 11001100 11011010 10101011 10100010 01001000 11100101 10001111 10000100 11110100 01011010 10111110 00111100 10101100 00000100 10100100 11111010 01110000 00110110 00001011 00000111 10111110 11110010 11100110 11110011 00100001 01110000 01110011 01110110 10110000 00110011 10001000 11000000 11000111 00001110 10011010 11110000 11110001 11110110 10111010 11000111 01110110 01111100 11110000 00100000 10001000 11110000 11100011 11010100 01100100 00011011 01010000 01110100 01000110 00000010 01100010 11100011 00110110 00110001 11101110 01011110 10011001 10001011 00111010 00110001 11111001 10100000 01100000 01100110 01011011 01111100 11110111 10011001 00101101 10000110 11011010 11000010 10110100 10001100 01111111 11111010 01100111 11001011 01000110 10110110 11001101 10100000 01001000 01011010 01011001 11110000 01000010")
'''

c4 = sequence_to_dec("00111111 11100111 01111100 00111010 01111001 00111000 00111011 10100110 01011001 01001001 10000000 11101110 10010110 10100110 00100101 11100110 01001001 10001000 11101000 00011001 11010101 00010111 10110010 01010010 10110011 11100011 00110101 01011111 10110010 01100100 10001000 11100011 00011001 11101001 10101010 01010010 01101000 00110001 11011000 10010001 01100110 10110001 00111011 00001000 01110001 10110111 11001101 00101011 11001001 10000111 01110000 11100001 10101111 00011101 01111100 10010010 10001001 01001010 10110111 11100100 10010111 01101011 10100111 10101011 10000010 10000111 10011100 11010000 00111110 01010101 00101011 10001110 01011100 10001110 11011111 00101111 10010110 01001001 00000111 00100001 01000011 11010001 00011000 11000010 10101001 10000101 11100110 01111110 11100011 10001100 10000110 10111011 00001110 10100110 01110011 10111010 00000100 10101111 10100011 00110100 00110010 01001110 00011000 10110100 10100000 11101011 10110110 01100010 01110010 01110011 01110111 11110100 00010010 11000111 11011010 11001011 00010101 11010010 10110011 11111000 11110011 10100101 11000000 01110110 00110101 10110101 00000010 11001101 11110111 11101011 11011010 01100010 01001000 00011111 00111100 01100101 00000011 00110110 10100111 00110010 00111100 11110000 01011110 10011010 10000001 01101000 00100100 11110011 10101100 01111010 00101111 01010101 01100001 11110111 10011010 00101101 10001010 10011001 11001011 11111000 10001000 00110111 10111001 01100000 11011001 01000110 10110111")

c20 = sequence_to_dec("00111010 11000000 01010000 00001011 00010001 01101011 01001100 10100111 01011000 00011010 10000100 11101110 10010000 10101000 00111101 11110000 00010011 10010111 10111100 00100010 11010001 00010001 11100100 01000100 10110101 11111110 01110110 01111010 11101011 00110011 10000000 10100010 00001001 11111100 10100011 01001100 01101111 00100011 11010110 ")

crib_for_that = "What's in a name? that which we call a" #c4, c20

def get_user_input():
	c1 = c20
	c2 = c4

	c1_len = len( c1 )
	c2_len = len( c2 )

	common_length = c1_len
	if c2_len < c1_len:
		common_length = c2_len

	c1 = c1[ :common_length ]
	c2 = c2[ :common_length ]

	c1_xor_c2 = xor( c1, c2 )

	crib = str( input( "Input crib: " ) )
	crib_dec = crib_to_dec( crib )
	crib_length = len( crib )

	for i in range( 0, common_length - crib_length ):
		xored = xor_crib_at( c1_xor_c2, crib_dec, i )
		string = result_to_string( xored )
		print( i, string )


get_user_input()
# 107 - "n the table" || " not Romeo "
# 01100010 01110010 01110011 01110111 11110100 00010010 11000111 11011010 11001011 00010101 11010010
# 00101100 00111100 01101000 01101011 10110001 01100000 11011100 11010110 11001100 00010110 10010111
#key = generate_keys( ord( "e" ), int( "11010010", 2 ) )[ 0 ]
#print( chr( int( "01100000", 2 ) ^ key ) )
#print( key )

# 62 - "the f" || " and "
# 11110000 10100101 10011001 10001111 11011000
# 10100100 10101100 10010010 11001011 10011110

# key = generate_keys( ord( "f" ), int( "11011000", 2 ) )[ 0 ]
#print( chr( int( "10101100", 2 ) ^ key ) )
#key = keys[ 0 ]
# print( key )

# 00010010 11000111 11011010 11001011 00010101 - Romeo ||  you 
# print( keys )
# print( chr( int( "01110111", 2 ) ^ 61 ) )

# get_user_input()

# while True:
# 	at = int(input("Podaj 'at': "))
# 	xored = xor_crib_at( c3_xor_c4, crib_dec, at )
# 	string = result_to_string( xored )

# 	print( "RESULT: ", string )

# 01100100 10001000 11100011 00011001 11101001
# 00110011 10011001 10101011 00011111 10101000


# c1 = sequence_to_dec("01100100 10001000 11100011 00011001 11101001")
# c2 = sequence_to_dec("00110011 10011001 10101011 00011111 10101000")

# key = crib_to_dec("we ca")
# keys = generate_keys( ord( "n" ), int( "10101010", 2 ) )
# print( chr( int("10101110", 2) ^ 196) )